<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Deep Dive: Streamlit Main Loop</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="slide fade-in">
    <div class="slide-header"></div>
    <div class="slide-content">
      <h1 class="slide-title">Step 8: Building the RAG UI with Streamlit</h1>
      <div class="two-panel">
        <div class="panel panel-text slide-in-left">
          
          <ul class="content-list template2-list">
            <li>This is the main function that orchestrates the entire user-facing process.</li>
          
            <li><strong>1. <code>st.chat_input</code>:</strong> Waits for the user to enter a question.</li>
            <li><strong>2. <code>search_manager.search</code>:</strong> Calls the information retrieval logic we built.</li>
            <li><strong>3. <code>chatbot.get_response</code>:</strong> Sends the context and question to Gemini to get an answer.</li>
            <li><strong>4. <code>st.markdown</code>:</strong> Displays the final answer to the user.</li>
          </ul>
        </div>
        <div class="panel slide-in-right">
          <div class="code-panel">
            <h3 class="code-title">Code Snippet & Explanation</h3>
            <pre class="code-content">
<span class="comment"># chat_txt_gemini.py</span>
<span class="keyword">def</span> <span class="function">main</span>():
    st.<span class="function">title</span>(<span class="string">"ðŸ’¬ Admissions Chatbot"</span>)
    
    <span class="comment"># ... (initialize components) ...</span>
    
    <span class="comment"># Get input from the user</span>
    <span class="keyword">if</span> prompt := st.<span class="function">chat_input</span>(<span class="string">"Enter your question..."</span>):
        <span class="comment"># Add the user's message to the chat history</span>
        st.session_state.messages.<span class="function">append</span>({<span class="string">"role"</span>: <span class="string">"user"</span>, <span class="string">"content"</span>: prompt})
        
        <span class="comment"># Display the user's message</span>
        <span class="keyword">with</span> st.<span class="function">chat_message</span>(<span class="string">"user"</span>):
            st.<span class="function">markdown</span>(prompt)

        <span class="comment"># Display the assistant's response</span>
        <span class="keyword">with</span> st.<span class="function">chat_message</span>(<span class="string">"assistant"</span>):
            <span class="comment"># 1. Search for context (Assuming search_manager is created)</span>
            relevant_chunks = search_manager.<span class="function">search</span>(prompt)
            context = <span class="string">"\n\n"</span>.<span class="function">join</span>(relevant_chunks)
            
            <span class="comment"># 2. Generate a response from the LLM</span>
            response = chatbot.<span class="function">get_response</span>(context, prompt)
            
            <span class="comment"># 3. Display the response</span>
            st.<span class="function">markdown</span>(response)
            </pre>
          </div>
        </div>
      </div>
    </div>
    <div class="slide-footer">
      <div class="footer-nav"><button class="nav-btn" onclick="previousSlide()">â—€ Prev</button></div>
      <div class="footer-center"><div class="footer-text">All these resources belong to FPT Greenwich. Any unauthorized copying, alteration, distribution outside our organization is strictly prohibited</div></div>
      <div class="footer-nav"><button class="nav-btn" onclick="nextSlide()">Next â–¶</button></div>
    </div>
  </div>
  <script src="presentation.js"></script>
</body>
</html>